# ADR-001: Форм-фактор и способ доставки мастера настройки рабочего места

- **Статус:** принят
- **Дата:** 2025-11-25

## Контекст

Для работы в ЛК ГИИС ЭБ пользователю нужно корректно настроенное рабочее место: браузер с ГОСТ TLS, CryptoPro CSP и плагин, корневые и промежуточные сертификаты, личный сертификат, драйвер токена и т.д.  
Существуют подробные текстовые инструкции, но их выполнение вручную занимает много времени и часто приводит к ошибкам.

Система должна:
- быть доступной пользователю из браузера на портале ГИИС ЭБ;
- минимизировать количество шагов и технических деталей для конечного пользователя;
- позволять выполнять системные действия (установка ПО, изменение настроек ОС),
  что требует прав локального администратора.

## Решение

Выбран подход **«портал + настольное приложение-мастер»**:

1. На портале размещается отдельная веб-страница входа, где:
   - есть кнопка «Приступить к работе» (переход в ЛК),
   - кнопка скачивания мастера автонастройки для Windows / Linux,
   - ссылка на инструкцию по ручной настройке,
   - блоки «Авария» (статусы подсистем) и «Новости».

2. Мастер автонастройки реализуется как **настольное приложение**:
   - отдельный EXE/installer для Windows,
   - отдельный дистрибутив (AppImage/скрипт) для Linux.
   Он скачивается и запускается пользователем локально, при необходимости — от имени администратора.

## Аргументы в пользу решения

- **Возможность системных изменений.** Только локальное приложение с правами администратора может устанавливать ПО, сертификаты, драйверы и менять системные настройки.
- **Надёжность и предсказуемость.** Сценарий не зависит от ограничений браузера, политик безопасности и расширений.
- **Понятный UX.** Пользователь выполняет простой сценарий:
  1) открывает страницу → 2) скачивает мастер → 3) запускает → 4) следует шагам.
- **Изоляция от портала.** Портал остаётся «тонким» интерфейсом: отдаёт файлы и показывает статусы/новости. Логика диагностики и настройки не нагружает сервер.

## Рассмотренные альтернативы

### Вариант A: Полностью браузерный мастер (через JS/плагины)

**Минусы:**
- нет доступа к системным операциям (установка CryptoPro, драйверов, сертификатов);
- зависимость от конкретных браузеров и их политик безопасности;
- высокий риск несовместимости между версиями ОС и браузеров.

**Вывод:** отвергнуто из-за технической нереализуемости полного сценария.

### Вариант B: Встроенный «тонкий» мастер в криптоклиенте/браузере

**Минусы:**
- сильная привязка к одному продукту (конкретному криптоклиенту/браузеру);
- усложнение обновления и сопровождения ПО;
- сложность масштабирования под несколько ОС.

**Вывод:** отвергнуто в пользу более независимого настольного приложения.

## Последствия

### Положительные

- Возможность автоматизировать максимальное число шагов настройки.
- Проще расширять функциональность мастера (новые проверки, новые версии ПО).
- Портал не перегружен логикой и остаётся относительно простым.

### Отрицательные

- Пользователь должен **скачать и запустить** файл — это требует ясной коммуникации и инструкций.
- Необходим отдельный процесс выпуска и обновления дистрибутивов мастера для каждой платформы.
- Часть организаций может накладывать ограничения на запуск внешних EXE/двойных файлов (потребуется согласование с ИБ). 
